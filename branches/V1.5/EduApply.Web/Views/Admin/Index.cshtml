@using EduApply.Web.Models
@model IEnumerable<AdminUserModel>
@{
    ViewBag.Title = "User Management";
    Layout = "~/Views/Shared/AdminLayout.cshtml";
}
<div class="form-group">
    @Html.ActionLink("Create User", "Create", null, new { @class = "btn btn-primary" })
</div>

<div class="panel panel-primary">
    <div class="panel-heading">
        User Accounts
    </div>
    <div class="table-responsive">
        <table id="UserTable" class="table table-striped table-responsive">
            <thead>
                <tr><th></th><th>Username</th><th>Role</th><th>Email</th><th>Phone Number</th><th></th></tr>
            </thead>
            <tbody>
                @if (Model.Count() == 0)
                {
                    <tr><td colspan="5" class="text-center">No User Accounts</td></tr>
                }
                else
                {
                    var i = 1;
                    foreach (var user in Model)
                    {

                        <tr id="@i">
                            @*<td>@user.Id</td>*@
                            <td>@i</td>
                            <td>@user.UserName</td>
                            <td>@user.UserRole</td>
                            <td>@user.Email</td>
                            <td>@user.PhoneNumber</td>

                            <td>
                                @if (user.IsActive)
                                {
                                    using (Html.BeginForm("Deactivate", "Admin", new { id = user.Id }))
                                    {
                                        @Html.ActionLink("Edit", "Edit", new { id = user.Id }, new { @class = "btn btn-primary btn-xs" })
                                        <button class="btn btn-danger btn-xs Deactivate" type="submit">Deactivate</button>
                                    }
                                }
                                else
                                {
                                    using (Html.BeginForm("Activate", "Admin", new { id = user.Id }))
                                    {
                                        @Html.ActionLink("Edit", "Edit", new { id = user.Id }, new { @class = "btn btn-primary btn-xs" })
                                        <button class="btn btn-success btn-xs Activate" type="submit">Activate &nbsp; &nbsp; &nbsp; </button>
                                    }
                                }



                                @*@using (Html.BeginForm("Delete", "Admin", new { id = user.Id }))
                                    {
                                        @Html.ActionLink("Edit", "Edit", new { id = user.Id }, new { @class = "btn btn-primary btn-xs" })
                                        <button class="btn btn-danger btn-xs" type="submit">Delete</button>
                                    }*@
                            </td>

                        </tr>
                                i++;
                    }
                }
            </tbody>


        </table>
    </div>

    @if (TempData["Deactivated"] != null && TempData["Deactivated"].ToString() == "Success")
    {
        <script type="text/javascript">
            $(function () {

                toastr.options =
                {
                    "closeButton": false,
                    "debug": false,
                    "progressBar": false,
                    "positionClass": "toast-top-center",
                    "onclick": null,
                    "showDuration": "300",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "1000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                };

                toastr.success("User Deactivated");
            })
        </script>
    }


    @if (TempData["Activated"] != null && TempData["Activated"].ToString() == "Success")
    {
        <script type="text/javascript">
            $(function () {

                toastr.options =
                {
                    "closeButton": false,
                    "debug": false,
                    "progressBar": false,
                    "positionClass": "toast-top-center",
                    "onclick": null,
                    "showDuration": "300",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "1000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                };

                toastr.success("User Activated");
            })
        </script>
    }

    @if (TempData["Deleted"] != null && TempData["Deleted"].ToString() == "Success")
    {
        <script type="text/javascript">
            $(function () {

                toastr.options =
                {
                    "closeButton": false,
                    "debug": false,
                    "progressBar": false,
                    "positionClass": "toast-top-center",
                    "onclick": null,
                    "showDuration": "300",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "1000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                };

                toastr.success("User Successfully Deleted");
            })
        </script>
    }

    @if (TempData["Created"] != null && TempData["Created"].ToString() == "Success")
    {
        <script type="text/javascript">
            $(function () {

                toastr.options =
                {
                    "closeButton": false,
                    "debug": false,
                    "progressBar": false,
                    "positionClass": "toast-top-center",
                    "onclick": null,
                    "showDuration": "300",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "1000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                };

                toastr.success("User Successfully Created. An activation mail has been sent to your email address");
            })
        </script>
    }
    @if (TempData["Edited"] != null && TempData["Edited"].ToString() == "Success")
    {
        <script type="text/javascript">
            $(function () {

                toastr.options =
                {
                    "closeButton": false,
                    "debug": false,
                    "progressBar": false,
                    "positionClass": "toast-top-center",
                    "onclick": null,
                    "showDuration": "300",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "1000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                };

                toastr.success("User Deatails Successfully Changed");
            })
        </script>
    }
</div>

<script>
    $(function () {
        $('#UserTable').dataTable();
        $(".Activate").click(function () {
            return confirm("Are you sure you want to Activate this User?");
        });

        $(".Deactivate").click(function () {
            return confirm("Are you sure you want to Deactivate this User?");
        });


    });
</script>